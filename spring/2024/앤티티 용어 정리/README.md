[개발서적] 자바/스프링 개발자를 위한 실용주의 프로그래밍 중 엔티티 정리 및 요약

엔티티 용어의 혼선

도메인 엔티티
도메인 엔티티를 알려면 도메인이 무엇인지 알아야함. 도메인은 비즈니스 영역임. 예를 들어 은행에서 사용할 소프트웨어를 만들고자 한다면 은행이 도메인임.

이러한 은행 도메인은 여러 개념이 등장함. 계좌, 거래, 돈 같은 개념임. 이러한 개념들을 도메인  모델이라고함. 이중에서 계좌와 거래는 돈의 속성과는 약간 다름. 도메인 모델에 맞는 비즈니스 갖을 수 있고, 고유 식별자가 존재하고, 생명주기(LifeCycle)을 가질 수도 있음. 이렇게 도메인 모델 중에서 특별한 기능을 갖는 모델은 도메인 엔티티라고 함.
정리하자면
1. 식별자를 갖는다
2. 도메인 로직을 갖는다.
와 같음

DB 엔티티
이 용어는 도메인 엔티티와 상관없이 원래 관계형 데이터베이스 분야에서 어떤 유무형의 객체를 표현하던데 사용했던 용어임.

JPA 엔티티
관계형 데이터베이스에 있는 데이터를 객체로 매핑하는 데 사용되는 클래스를 JPA 엔티티라고 부름. JPA 엔티티를 DB 엔티티나 도메인 엔티티와 비교하자면 DB 엔티티에 더 가까운 개념임. 실제로 JPA 엔티티에서 매핑하는 어노테이션은 데이터베이스에서 사용하는 용어를 그대고 가져옴(@Table, @Column)
따라서 엔티티는 JPA의 @Entity로 선언된 클래스다라는 답변은 틀림.

소프트웨어 개발에서 엔티티는 도메인 엔티티임. 반면 JPA 엔티티는 DB 엔티티에 뿌리를 둠. 이러한 개념적 불일치는 별것 아닌 것처럼 보일 수 있으나 이를 제대로 구분하느냐에 따라 개발 결과물이 달라질 . 수있음. 단적인 예로 엔티티를 JPA 엔티티로 인식하는 개발자는 관계형 데이터베이스에 종속된 프로그램을 만들 확률이 높음. 

정리

엔티티의 시작은 현실 세계의 사물을 데이터로 정의할 때 어떻게 정의할 것인가 고민한 결과임
만약 회원이란 현실 세계의 존재는 이름, 나이, 성별이란 데이터로 정의할 수 있음. 이러한 정의를 엔티티라고 하였음.

데이터베이스 세계에서는 엔티티를 테이블로 표현함
객체지향 세계에서는 엔티티를 사물로 표현함

이렇게 시작은 비슷했을지 몰라도 결과물은 너무나도 달랐기 때문에 양쪽을 1:1로 매핑하기에는 무리가 있었음.

개발자는 데이터베이스에서 데이터를 가져와 도메인 모델에다 데이터를 잘 옮기는 작업을 해야했고, 라이브러리들이 등장했는데 대표적으로 MyBatis가 있음. MyBatis를 통해 필요한 데이터를 선택적으로 가져와 쿼리의 결과를 도메인 모델에 매핑했음. 하지만 이런 작업은 번거러웠고 곧 ORM(object-relational mapping)이라는 솔루션이 등장함.

JPA 엔티티란 무엇일까? 설명하기 애매하지만 다음과 같이 정리할 수 있음.
1. JPA 엔티티는 관계형 데이터베이스의 엔티티를 지칭하는 것
2. JPA의 @Entity 어노테이션이 적용된 객체는 영속성 객체(Persistent Object)다.
3. JPA의 @Entity 어노테이션은 영속성 객체를 만들기 위한 도구일 뿐이다.
JPA 엔티티는 이러한 테이블의 정보를 담는 객체임. 데이터베이스 엔티티와 관계 있음.
JPA 엔티티는 영속성 객체라고 표현할 수 있음. JPA엔티티는 영속성 객체를 만들기 위한 도구일 뿐임. JPA의 @Entitys는 소프트웨어 개발 분야의 엔티티라고 볼 수 없음.