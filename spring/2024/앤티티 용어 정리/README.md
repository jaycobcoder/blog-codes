[개발서적] 자바/스프링 개발자를 위한 실용주의 프로그래밍 중 엔티티 정리 및 요약

## 엔티티란 용어의 혼선
오늘날 많은 개발자들이 엔티티란 용어를 혼선한다. 특히 JPA란 ORM이 대두되면서 엔티티와 JPA 엔티티를 혼용하는 일이 많아졌다. '엔티티는 DB에 매칭되며 JPA의 @Entity 어노테이션을 붙인 클래스'라고 설명하는 글들도 많다. 하지만 **엔티티는 JPA가 없던 시절부터 존재하던 개념**이다. JPA의 엔티티는 이런 엔티티를 표현하기 위한 수단 중에 하나이다.

1. 도메인 엔티티
2. DB 엔티티
3. JPA 엔티티

엔티티는 **보편적인 개념**이다. 이 개념이 어느 곳에서 사용하느냐에 따라 도메인 엔티티, DB 엔티티, JPA 엔티티가 되는 것이다. 즉 '엔티티는 DB에 매칭되며 JPA의 @Entity 어노테이션을 붙인 클래스'라고 설명은 올바르지 않는 설명이다.

## 1. 도메인 엔티티
도메인 엔티티를 알려면 **도메인**이 무엇인지 알아야 한다. 도메인은 우리가 해결해야 하는 비즈니스 영역이다. 예를 들어 은행에서 사용할 소프트웨어를 만들고자 한다면 은행이 도메인이 된다.

이런 은행 도메인 아래에는 여러 개념이 존재한다. 계좌(Account), 거래(Transaction), 돈(Money)와 같은 개념들이다. 이러한 개념들을 **도메인 모델**이라고 한다.

이런 도메인 모델 중에서 계좌와 거래에 주목하자. 이 둘의 모델은 돈과는 사뭇 다르다. 이 모델들은 도메인 모델에 맞는 비즈니스 로직을 가질 수 있고, 고유 식별자가 존재하며, 생명주기(LifeCycle)이 있을 수 있다. 이렇게 도메인 모델 중에서 특별한 기능을 갖는 모델을 **도메인 엔티티**라고 한다.

도메인 엔티티를 정리하자면
1. 식별자를 갖는다.
2. 도메인 로직을 갖는다.

와 같다.

## DB 엔티티
이 용어는 도메인 엔티티와 상관없이 원래 관계형 데이터베이스 분야에서 어떤 유무형의 객체를 표현하는 데 사용했던 용어이다.
> 여기서 객체는 객체지향의 객체가 아닌 정보를 담고 있는 데이터 모델로 이해하자

## JPA 엔티티
관계형 데이터베이스에 있는 데이터를 객체로 매핑하는 데 사용되는 클래스를 JPA 엔티티라고 부른다. DB 엔티티나 도메인 엔티티와 비교하자면, JPA 엔티티는 DB 엔티티에 더 가까운 개념이다.

실제 JPA는 @Table, @Column과 같은 데이터베이스 용어를 사용한다. 소프트웨어 개발 분야에서 말하는 엔티티는 도메인 엔티티이다. 반면 JPA 엔티티는 DB 엔티티에 더 가깝다.

이러한 개념적 불일치는 별것 아닌 것처럼 보일 수 있으나 이를 제대로 구분하느냐에 따라 개발 결과물이 달라질 수 있다. 단적인 예로 엔티티를 JPA 엔티티로 인식하는 개발자는 관계형 데이터베이스에 종속된 프로그램을 만들 확률이 높음. 

## 정리
엔티티의 시작은 현실 세계의 사물을 데이터로 정의할 때 어떻게 정의할 것인가 고민한 결과이다.
가령 사용자란 현실 세계의 존재를 데이터로 표현하기 위해서는 이름, 나이, 성별이란 데이터로 정의할 수 있을 것이다. 그럼 이런 '사용자'와 같은 자산은 무엇으로 부르면 좋을까? 프로그래밍과 데이터베이스 분야에서는 이런 자산 정보를 지칭하는 데 엔티티란 표현을 사용하였다.
>엔티티는 개체란 뜻을 가지고 있다.

이런 자산 정보인 엔티티를 데이터베이스 세계에서는 테이블로 표현하였고, 객체지향 세계에서는 엔티티를 클래스로 표현하였다.

당여한 것이 객체지향 세계에서는 객체들간의 협력을 추구하였고 데이터베이스 세계에서는 데이터의 정합성, 중복 제거 등을 중요하게 여겼기 대문이다.

이렇게 표현된 엔티티는 각자의 세계에서 잘 적용되었으나, 현실 세계의 서비스를 만들어야 하는 상황이 생겼다. 하지만 서로의 시작은 비슷했을지 몰라도 결과물은 너무나도 달랐기 때문에 양쪽을 1:1로 매핑하기에는 무리가 있엇다.

개발자는 데이터베이스에서 데이터를 가져와 도메인 모델에다 데이터를 잘 옮기는 작업을 해야했고, 라이브러리들이 등장했는데 대표적으로 MyBatis가 있었다. MyBatis를 통해 필요한 데이터를 선택적으로 가져와 쿼리의 결과를 도메인 모델에 매핑했다. 하지만 이런 작업은 번거러웠고 곧 ORM(object-relational mapping)이라는 솔루션이 등장했다.
